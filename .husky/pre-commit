#!/bin/sh


echo "ğŸš€ Running pre-commit checks..."

# Check for uncommitted changes in package.json
if git diff --cached --name-only | grep -q "package.json"; then
  echo "ğŸ“¦ package.json changed. Running pnpm install..."
  pnpm install || {
    echo "âŒ pnpm install failed"
    exit 1
  }
fi


# Run ESLint
echo "ğŸ” Running ESLint..."
pnpm lint || {
  echo "âŒ ESLint check failed. Please fix the errors and try again."
  exit 1
}

# Run type checking
echo "âœ¨ Running TypeScript check..."
pnpm tsc --noEmit || {
  echo "âŒ TypeScript check failed. Please fix type errors and try again."
  exit 1
}

# Run lint-staged for other checks (formatting, etc)
echo "ğŸ¯ Running lint-staged..."
pnpm lint-staged || {
  echo "âŒ lint-staged failed. Please fix the issues and try again."
  exit 1
}

echo "âœ… All pre-commit checks passed!"

